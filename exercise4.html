<!DOCTYPE HTML>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>省市联动</title>
</head>
<body>
<select id="province" name="province">
    <option value="请选择。。。" selected="selected">请选择。。。</option>
    <option value="山东省">山东省</option>
    <option value="河北省">河北省</option>
    <option value="北京市">北京市</option>
</select>
<select id="city" name="city">
    <option selected="selected">请选择。。。</option>
</select>

<script type="text/javascript">
    window.onload = function () {
        document.getElementById("province").onchange = function () {
            //获取当前选中的省份
            var changeProvince = this.value;
            //清空city下拉,每次选择前都要清空，不然下拉框中会保存上一次的城市列表
            var selectElement = document.getElementById("city");
            var optionElement = selectElement.getElementsByTagName("option");
            //从前往后删除，第一次会先把“请选择”删除，然后清掉一个后，optionElement.length会减一
            //第一个删除济南后,青岛会排在[0]位置上，此时会删除[1]=诸城。
            /*for (var i = 0;i<optionElement.length; i++) {
                 // alert(optionElement.length);
                //alert(optionElement[i].firstChild.nodeValue);  //可以查看删除了哪个
                selectElement.removeChild(optionElement[i]);
            }*/
            //从后往前删除,这样不管长度怎么变化，总是会删除全部，只保留第一个"请选择" 。
            for(var i=optionElement.length-1;i>0;i--){
             selectElement.removeChild(optionElement[i]);
             }
            //解析Xml文件
            var XMLDoc = parseXml("cities.xml");
            if (XMLDoc == null) {
                alert('您的浏览器不支持xml文件读取,于是本页面禁止您的操作,推荐使用IE5.0以上可以解决此问题!');
                window.location.href = '/Index.aspx';
            }
            //获取xml中所有省份
            var xmlprovinceElement = XMLDoc.getElementsByTagName("province");
//                alert(xmlprovinceElement.length);
            //如果xml省份的属性值等于当前选中的省份，则取出这个省的元素到外面
            var provinceElement = null;
            for (var i = 0; i < xmlprovinceElement.length; i++) {
                var xmlprovince = xmlprovinceElement[i];
                var xmlprovincename = xmlprovince.getAttribute("name");
                if (changeProvince == xmlprovincename) {
                    provinceElement = xmlprovince;
                    break;
                }
            }

            if (provinceElement != null) {
                //获取所有city节点
                var cityElement = provinceElement.getElementsByTagName("city");
                for (var i = 0; i < cityElement.length; i++) {
                    var city = cityElement[i].firstChild.nodeValue;
                    //创建option标签
//                    <option value="山东省">济南....</option>
                    var optionElement = document.createElement("option");
                    optionElement.setAttribute("value", city);
                    var optionText = document.createTextNode(city);
                    optionElement.appendChild(optionText);
                    selectElement.appendChild(optionElement);
                }
            }
        }
    }
    //以下两种解析Xml方法都可以
    function parseXml(filename) {
        var xmlDoc;
        try {
            xmlDoc = new ActiveXObject("Microsoft.XMLDOM");
        } catch (e) {
            try {
                xmlDoc = document.implementation.createDocument("", "", null);
            } catch (e) {
                alert(e.message);
                return;
            }
        }
        xmlDoc.async = false;
        xmlDoc.load(filename);
        return  xmlDoc;
    }
    /*function  parseXml(filename){
     var xmlDoc;
     if(window.ActiveXObject)
     {
     xmlDoc    = new ActiveXObject("Microsoft.XMLDOM");
     xmlDoc.async    = false;
     xmlDoc.load(filename);
     }
     else if (document.implementation&&document.implementation.createDocument)
     {
     xmlDoc    = document.implementation.createDocument("","",null);
     xmlDoc.async=false;
     xmlDoc.load(filename);
     }
     else
     {
     return null;
     }

     return xmlDoc;
     }*/
</script>
</body>
</html>